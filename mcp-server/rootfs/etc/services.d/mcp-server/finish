#!/usr/bin/with-contenv bashio
# ==============================================================================
# Take down the MCP Server service
# ==============================================================================

bashio::log.info "MCP Server service stopping..."

# The exec in the run script should handle the process cleanup
# We just log the exit status

# Check exit code
if [[ "${1}" -eq 0 ]] || [[ "${1}" -eq 256 ]]; then
    bashio::log.info "MCP Server stopped cleanly"
else
    bashio::log.error "MCP Server crashed with exit code ${1}"
    # If it crashed, wait a bit before S6 restarts it
    sleep 5
fi